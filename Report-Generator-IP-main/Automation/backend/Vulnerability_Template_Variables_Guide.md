# Vulnerability Template Variables Guide

## Overview
This guide shows how to add vulnerability sections to your `CSS Certin temp.docx` template for dynamic vulnerability explanations with PoC images.

## Vulnerability Template Variables

### 1. Vulnerability Loop Structure
Add this structure to your Word template where you want vulnerabilities to appear:

```
{% for vuln in VULNERABILITIES %}
<!-- Vulnerability Section Start -->
{% endfor %}
```

### 2. Individual Vulnerability Fields
Within the vulnerability loop, use these variables:

#### Basic Information
```
{{vuln.observation_number}} - Observation Number (1, 2, 3, etc.)
{{vuln.vulnerability_id}} - Vulnerability ID (VULN-001, VULN-002, etc.)
{{vuln.severity}} - Severity (Critical, High, Medium, Low, Informational)
{{vuln.status}} - Status (Open, Closed, etc.)
{{vuln.cve_cwe}} - CVE/CWE Reference
{{vuln.cvss}} - CVSS Score
{{vuln.cvss_vector}} - CVSS Vector String
{{vuln.affected_asset}} - Affected Asset URL/IP
{{vuln.title}} - Vulnerability Title
```

#### Detailed Description
```
{{vuln.description}} - Detailed vulnerability description
{{vuln.impact}} - Impact statement
{{vuln.reproduction_steps}} - Steps to reproduce
```

#### Recommendations
```
{% for rec in vuln.recommendations %}
{{rec}} - Individual recommendation
{% endfor %}
```

#### PoC Images
```
{% if vuln.has_poc %}
{% for poc in vuln.poc_images %}
<!-- Insert PoC image: {{poc.filename}} -->
{% endfor %}
{% endif %}
```

### 3. Vulnerability Summary Variables
Use these for summary sections:

```
{{HAS_VULNERABILITIES}} - Boolean: true if vulnerabilities exist
{{VULNERABILITY_COUNT}} - Total number of vulnerabilities
```

### 4. Complete Vulnerability Section Template

Here's a complete template structure for a vulnerability section:

```
{% if HAS_VULNERABILITIES %}
## Summary of Findings

Total Vulnerabilities Found: {{VULNERABILITY_COUNT}}

{% for vuln in VULNERABILITIES %}
### Observation #{{vuln.observation_number}}

**Severity:** {{vuln.severity}}
**Status:** {{vuln.status}}
**CVE/CWE:** {{vuln.cve_cwe}}
**CVSS:** {{vuln.cvss}}
**CVSS Vector:** {{vuln.cvss_vector}}
**Affected Asset:** {{vuln.affected_asset}}

**Vulnerability Title:** {{vuln.title}}

**Detailed Observation/Vulnerable Point:**
{{vuln.description}}

**Impact:**
{{vuln.impact}}

**Reproduction Steps:**
{{vuln.reproduction_steps}}

**Recommendations:**
{% for rec in vuln.recommendations %}
{{loop.index}}. {{rec}}
{% endfor %}

{% if vuln.has_poc %}
**Evidence/Proof of Concept:**
{% for poc in vuln.poc_images %}
**Step {{loop.index}}:**
<!-- Insert image: {{poc.filename}} -->
{% endfor %}
{% endif %}

---
{% endfor %}
{% endif %}
```

## Excel File Structure Requirements

Your `certin_vulnerability_format.xlsx` should have these columns:

| Column Name | Description | Example |
|-------------|-------------|---------|
| Vulnerability_ID | Unique identifier | VULN-001 |
| Severity | Severity level | Critical, High, Medium, Low |
| Status | Current status | Open, Closed |
| CVE_CWE | CVE/CWE reference | CWE-284 |
| CVSS | CVSS score | 8.7 |
| CVSS_Vector | CVSS vector string | 4.0/AV:N/AC:L/... |
| Affected_Asset | URL or IP address | https://example.com |
| Vulnerability_Title | Short title | SQL Injection in Login |
| Detailed_Description | Full description | The login page is vulnerable... |
| Impact | Impact statement | Attackers can bypass authentication... |
| Recommendations | Remediation steps | Use parameterized queries... |
| Reproduction_Steps | Steps to reproduce | 1. Access login page... |

## PoC Zip File Structure

### Naming Convention
- **Zip File:** `VULN-001_poc.zip`
- **Contents:** `step1.png`, `step2.png`, `step3.png`, etc.

### Example Structure
```
VULN-001_poc.zip
├── step1.png (Login page screenshot)
├── step2.png (Payload injection)
├── step3.png (Error message)
└── step4.png (Successful bypass)

VULN-002_poc.zip
├── step1.png (Initial request)
├── step2.png (XSS payload)
└── step3.png (Alert execution)
```

## Template Integration Steps

### Step 1: Add Vulnerability Sections
1. Open your `CSS Certin temp.docx` template
2. Find where you want vulnerability sections to appear
3. Add the vulnerability loop structure

### Step 2: Configure Image Handling
For PoC images, you'll need to:
1. Use `docxtpl`'s `InlineImage` feature
2. Ensure images are properly embedded in the document

### Step 3: Test Template
1. Upload a sample Excel file with vulnerability data
2. Upload corresponding PoC zip files
3. Generate a test report
4. Verify all variables are properly replaced

## Advanced Template Features

### Conditional Sections
```
{% if vuln.severity == 'Critical' %}
**⚠️ CRITICAL VULNERABILITY ⚠️**
{% endif %}
```

### Severity-based Styling
```
{% if vuln.severity == 'Critical' %}
<!-- Red highlighting for critical -->
{% elif vuln.severity == 'High' %}
<!-- Orange highlighting for high -->
{% endif %}
```

### PoC Image with Captions
```
{% if vuln.has_poc %}
**Proof of Concept:**
{% for poc in vuln.poc_images %}
**Step {{loop.index}}:** {{poc.filename}}
<!-- Insert image: {{poc.filename}} -->
{% endfor %}
{% endif %}
```

## Troubleshooting

### Common Issues
1. **Variables not replaced:** Check exact variable names (case-sensitive)
2. **Images not showing:** Ensure proper image path and format
3. **Loop not working:** Check loop syntax and data structure
4. **Empty sections:** Verify Excel data has required columns

### Debug Tips
1. Test with simple variables first
2. Check Excel file structure matches requirements
3. Verify PoC zip file naming convention
4. Test template with sample data

## Support

If you encounter issues:
1. Check variable names match exactly
2. Verify Excel file has all required columns
3. Ensure PoC zip files follow naming convention
4. Test with minimal data first
